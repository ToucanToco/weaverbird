---
exclude:
- mongo
- pandas
- snowflake
- redshift_pypika
- athena_pypika
- bigquery_pypika
input:
  data:
  - name: Brewdog Nanny State Alcoholvrij
    price_per_l: 0.005
  - name: Pauwel Kwak
    price_per_l: 0.084
  - name: Superstrong beer
    price_per_l: 0.16
  - name: Weihenstephan Hefe Weizen Alcoholarm
    price_per_l: 0.005
  schema:
    fields:
    - name: name
      type: string
    - name: price_per_l
      type: number
    pandas_version: 1.4.0
expected:
  data:
    - name: Brewdog Nanny State Alcoholvrij
    - name: Pauwel Kwak
    - name: Superstrong beer
    - name: Weihenstephan Hefe Weizen Alcoholarm
  schema:
    fields:
    - name: name
      type: string
    pandas_version: 1.4.0
step:
  name: _customsql
  pipeline:
  - name: _customsql
    query: |
      /* Are we going to support SET or not ? */
      SELECT set_config('client_min_messages', 'log', TRUE);
      SELECT "name" FROM "beers_tiny";
