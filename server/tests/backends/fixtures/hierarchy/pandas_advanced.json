{
  "exclude": [
    "mysql",
    "postgres",
    "snowflake",
    "mongo"
  ],
  "step": {
    "pipeline": [
      {
        "name": "domain",
        "domain": "in"
      },
      {
        "name": "hierarchy",
        "hierarchy": [
          "country",
          "region"
        ],
        "hierarchy_level_column": "level"
      }
    ]
  },
  "input": {
    "schema": "geojson",
    "data": {
      "type": "FeatureCollection",
      "features": [
        {
          "type": "Feature",
          "properties": {
            "city": "city_1",
            "country": "space",
            "region": "region_1"
          },
          "geometry": {
            "type": "Polygon",
            "coordinates": [
              [
                [
                  1.7660522460937498,
                  48.62564740882851
                ],
                [
                  2.3785400390625,
                  48.62564740882851
                ],
                [
                  2.3785400390625,
                  49.043269300657656
                ],
                [
                  1.7660522460937498,
                  49.043269300657656
                ],
                [
                  1.7660522460937498,
                  48.62564740882851
                ]
              ]
            ]
          }
        },
        {
          "type": "Feature",
          "properties": {
            "city": "city_2",
            "country": "space",
            "region": "region_1"
          },
          "geometry": {
            "type": "Polygon",
            "coordinates": [
              [
                [
                  2.6641845703125,
                  48.75618876280552
                ],
                [
                  2.1807861328125,
                  48.857487002645485
                ],
                [
                  2.0159912109375,
                  48.49112712828191
                ],
                [
                  2.4774169921874996,
                  48.35442390123028
                ],
                [
                  2.6641845703125,
                  48.75618876280552
                ]
              ]
            ]
          }
        },
        {
          "type": "Feature",
          "properties": {
            "city": "city_3",
            "country": "space",
            "region": "region_2"
          },
          "geometry": {
            "type": "Polygon",
            "coordinates": [
              [
                [
                  2.21099853515625,
                  48.93152205931365
                ],
                [
                  2.8125,
                  48.93152205931365
                ],
                [
                  2.8125,
                  49.10983779052439
                ],
                [
                  2.21099853515625,
                  49.10983779052439
                ],
                [
                  2.21099853515625,
                  48.93152205931365
                ]
              ]
            ]
          }
        }
      ]
    }
  },
  "expected": {
    "schema": "geojson",
    "data": {
      "type": "FeatureCollection",
      "features": [
        {
          "type": "Feature",
          "properties": {
            "city": "city_1",
            "country": "space",
            "level": 2,
            "region": "region_1"
          },
          "geometry": {
            "type": "Polygon",
            "coordinates": [
              [
                [
                  1.7660522460937498,
                  48.62564740882851
                ],
                [
                  2.3785400390625,
                  48.62564740882851
                ],
                [
                  2.3785400390625,
                  49.043269300657656
                ],
                [
                  1.7660522460937498,
                  49.043269300657656
                ],
                [
                  1.7660522460937498,
                  48.62564740882851
                ]
              ]
            ]
          }
        },
        {
          "type": "Feature",
          "properties": {
            "city": "city_2",
            "country": "space",
            "level": 2,
            "region": "region_1"
          },
          "geometry": {
            "type": "Polygon",
            "coordinates": [
              [
                [
                  2.6641845703125,
                  48.75618876280552
                ],
                [
                  2.1807861328125,
                  48.857487002645485
                ],
                [
                  2.0159912109375,
                  48.49112712828191
                ],
                [
                  2.4774169921874996,
                  48.35442390123028
                ],
                [
                  2.6641845703125,
                  48.75618876280552
                ]
              ]
            ]
          }
        },
        {
          "type": "Feature",
          "properties": {
            "city": "city_3",
            "country": "space",
            "level": 2,
            "region": "region_2"
          },
          "geometry": {
            "type": "Polygon",
            "coordinates": [
              [
                [
                  2.21099853515625,
                  48.93152205931365
                ],
                [
                  2.8125,
                  48.93152205931365
                ],
                [
                  2.8125,
                  49.10983779052439
                ],
                [
                  2.21099853515625,
                  49.10983779052439
                ],
                [
                  2.21099853515625,
                  48.93152205931365
                ]
              ]
            ]
          }
        },
        {
          "type": "Feature",
          "properties": {
            "city": null,
            "country": "space",
            "level": 1,
            "region": "region_1"
          },
          "geometry": {
            "type": "Polygon",
            "coordinates": [
              [
                [
                  2.6641845703125,
                  48.75618876280552
                ],
                [
                  2.4774169921874996,
                  48.35442390123028
                ],
                [
                  2.0159912109375,
                  48.49112712828191
                ],
                [
                  2.0765007281486585,
                  48.62564740882851
                ],
                [
                  1.7660522460937498,
                  48.62564740882851
                ],
                [
                  1.7660522460937498,
                  49.043269300657656
                ],
                [
                  2.3785400390625,
                  49.043269300657656
                ],
                [
                  2.3785400390625,
                  48.81604681362005
                ],
                [
                  2.6641845703125,
                  48.75618876280552
                ]
              ]
            ]
          }
        },
        {
          "type": "Feature",
          "properties": {
            "city": null,
            "country": "space",
            "level": 1,
            "region": "region_2"
          },
          "geometry": {
            "type": "Polygon",
            "coordinates": [
              [
                [
                  2.21099853515625,
                  48.93152205931365
                ],
                [
                  2.8125,
                  48.93152205931365
                ],
                [
                  2.8125,
                  49.10983779052439
                ],
                [
                  2.21099853515625,
                  49.10983779052439
                ],
                [
                  2.21099853515625,
                  48.93152205931365
                ]
              ]
            ]
          }
        },
        {
          "type": "Feature",
          "properties": {
            "city": null,
            "country": "space",
            "level": 0,
            "region": null
          },
          "geometry": {
            "type": "Polygon",
            "coordinates": [
              [
                [
                  2.6641845703125,
                  48.75618876280552
                ],
                [
                  2.4774169921874996,
                  48.35442390123028
                ],
                [
                  2.0159912109375,
                  48.49112712828191
                ],
                [
                  2.0765007281486585,
                  48.62564740882851
                ],
                [
                  1.7660522460937498,
                  48.62564740882851
                ],
                [
                  1.7660522460937498,
                  49.043269300657656
                ],
                [
                  2.21099853515625,
                  49.043269300657656
                ],
                [
                  2.21099853515625,
                  49.10983779052439
                ],
                [
                  2.8125,
                  49.10983779052439
                ],
                [
                  2.8125,
                  48.93152205931365
                ],
                [
                  2.3785400390625,
                  48.93152205931365
                ],
                [
                  2.3785400390625,
                  48.81604681362005
                ],
                [
                  2.6641845703125,
                  48.75618876280552
                ]
              ]
            ]
          }
        }
      ]
    }
  }
}